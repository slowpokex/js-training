{"version":3,"sources":["webpack:///./classes/loader.js","webpack:///./handlers/artistHandler.js","webpack:///./handlers/mainHandler.js","webpack:///./classes/albumsList.js","webpack:///./classes/artistInfo.js","webpack:///./classes/artistList.js","webpack:///./classes/searchArtist.js","webpack:///./classes/albumInfo.js","webpack:///./handlers/searchHandler.js"],"names":[],"mappings":";;;;;;;;AAAA;AACA,mBAAkC;;AAElC;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;;;;;;;;;;;;AC/DA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH,C;;;;;;;;;;;;;;;;;;;ACnFA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA,qBAAqB,UAAU;AAC/B;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,KAAK;AACL,GAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;;;;;;;;;;ACjKA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,gF;;;;;;;;;;AChBA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;ACdA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;ACdA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;AChBA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;;AChBA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL,GAAG;;AAEH,OAAO,iBAAiB;;AAExB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA,qD","file":"bundle.js","sourcesContent":["'use strict';\r\nexport default function Loader() { }\r\n\r\nconst PROTO = Loader.prototype;\r\n\r\n//Settings for Last.FM application\r\nPROTO.API_KEY = '9a5f1f19efe1727160e4dbb5e4367b9d';\r\nPROTO.SECRET_KEY = '92348e86733362627fd83e30dba8046e';\r\nPROTO.START_URL = 'http://ws.audioscrobbler.com/2.0/?';\r\nPROTO.FORMAT = 'json';\r\n\r\nPROTO.METHOD_KEY = 'method=';\r\nPROTO.ARTIST_KEY = '&artist=';\r\nPROTO.ALBUM_KEY = '&album=';\r\nPROTO.PAGE_KEY = '&page=';\r\nPROTO.LIMIT_KEY = '&limit=';\r\n\r\nPROTO.LINE_API_KEY = '&api_key=' + PROTO.API_KEY;\r\nPROTO.LINE_FORMAT = '&format=' + PROTO.FORMAT;\r\nPROTO.QUERY_POSTFIX = PROTO.LINE_API_KEY + PROTO.LINE_FORMAT;\r\n\r\nPROTO.generatePage = function (page) {\r\n  return PROTO.PAGE_KEY + (page || 1);\r\n};\r\n\r\nPROTO.generateLimit = function (page) {\r\n  return PROTO.LIMIT_KEY + (page || 50);\r\n};\r\n\r\nPROTO.returnMethodQuery = function (method) {\r\n  return Loader.prototype.METHOD_KEY + method;\r\n};\r\n\r\nPROTO.returnArtistParameter = function (value) {\r\n  return Loader.prototype.ARTIST_KEY + value;\r\n};\r\n\r\nPROTO.returnAlbumParameter = function (value) {\r\n  return Loader.prototype.ALBUM_KEY + value;\r\n};\r\n\r\nPROTO.inherits = function (child) {\r\n  child.prototype = Object.create(PROTO);\r\n  child.prototype.constructor = child;\r\n};\r\n\r\nPROTO.load = function (queryParams) {\r\n  return new Promise(function (resolve, reject) {\r\n    const xhr =  new XMLHttpRequest();\r\n    xhr.open('GET', queryParams, true);\r\n    xhr.setRequestHeader(\"Cache-Control\", 'no-cache');\r\n\r\n    xhr.send();\r\n\r\n    xhr.onreadystatechange = function() {\r\n      if (this.readyState !== 4) return;\r\n      if (this.status !== 200) {\r\n        reject(this);\r\n        return;\r\n      }\r\n      resolve(this);\r\n    };\r\n  });\r\n};\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./classes/loader.js\n// module id = 0\n// module chunks = 0","'use strict';\r\nimport * as mainHandler from '../handlers/mainHandler';\r\nimport ArtistInfo from '../classes/artistInfo';\r\nimport AlbumsList from '../classes/albumsList';\r\n\r\nfunction addInfo(artist, resultBox) {\r\n  let bio = artist['bio']['content'];\r\n  let text = document.createElement('div');\r\n  text.classList.add('info-box');\r\n  text.innerHTML = bio;\r\n  resultBox.appendChild(text);\r\n}\r\n\r\nfunction addAlbumsOnArtistPage(response, resultBox) {\r\n\r\n  function addHeadOfAlbums(fragment) {\r\n    let albumHead = document.createElement('span');\r\n    albumHead.classList.add('head');\r\n    albumHead.innerHTML = 'Top albums:<br/>';\r\n    fragment.appendChild(albumHead);\r\n  }\r\n\r\n  function addAlbumInPage(album, fragment) {\r\n    let name = album['name'];\r\n    let imageSrc = album['image'][2]['#text'];\r\n    let img = document.createElement('img');\r\n    img.classList.add('element');\r\n    img.src = imageSrc;\r\n    img.title = name;\r\n\r\n    if (img.title === '(null)') return;\r\n    \r\n    fragment.appendChild(img);\r\n    return img;\r\n  }\r\n\r\n  let fragment  = document.createDocumentFragment();\r\n  addHeadOfAlbums(fragment);\r\n  const albums = response['topalbums']['album'];\r\n\r\n  albums.forEach(function (album) {\r\n    addAlbumInPage(album, fragment);\r\n  });\r\n\r\n  resultBox.appendChild(fragment);\r\n}\r\n\r\nfunction addAlbums(artist, resultBox) {\r\n  const artistName = artist['name'];\r\n  let albumInfo = new AlbumsList();\r\n  const result = albumInfo.load(artistName);\r\n  result.then(res => {\r\n    const responseObj = JSON.parse(res.responseText);\r\n    addAlbumsOnArtistPage(responseObj, resultBox);\r\n  });\r\n}\r\n\r\nfunction addArtistToMainPage(response) {\r\n  const resultBox = document.querySelector('.result-box');\r\n  resultBox.innerHTML = '';\r\n\r\n  const artistBox = document.createElement('div');\r\n  artistBox.className = 'artist-box';\r\n  resultBox.appendChild(artistBox);\r\n  const artist = response['artist'];\r\n\r\n  mainHandler.addArtistImage(artist, artistBox, 'artist');\r\n  mainHandler.addLikes(artist[\"stats\"][\"listeners\"]);\r\n  addInfo(artist, artistBox);\r\n  addAlbums(artist, resultBox);\r\n}\r\n\r\nexport function loadArtistOnMainPage(name) {\r\n  mainHandler.addHead(name);\r\n  mainHandler.addSpinner();\r\n  mainHandler.cleanContentForArtist();\r\n  const artist = new ArtistInfo();\r\n  const result = artist.load(name);\r\n\r\n  result.then(res => {\r\n    const responseObj = JSON.parse(res.responseText);\r\n    addArtistToMainPage(responseObj)\r\n  });\r\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./handlers/artistHandler.js\n// module id = 1\n// module chunks = 0","'use strict';\r\nimport ArtistList from '../classes/artistList';\r\nimport * as artistHandler from '../handlers/artistHandler';\r\n\r\nfunction generateRangeForPagination(currPage, maxPages) {\r\n  let arr = [];\r\n\r\n  currPage = Number.parseInt(currPage);\r\n  maxPages = Number.parseInt(maxPages);\r\n\r\n  const vault = 3;\r\n  let start, end;\r\n  if (currPage < vault + 1) {\r\n    start = 1;\r\n    end = (2 * vault) + 1;\r\n  } else if (currPage > maxPages - vault) {\r\n    start = maxPages - ((2 * vault) + 1);\r\n    end = maxPages;\r\n  } else {\r\n    start = currPage - vault;\r\n    end = currPage + vault;\r\n  }\r\n\r\n  for (let i = start; i <= end; i++) {\r\n    arr.push(i);\r\n  }\r\n\r\n  return arr;\r\n}\r\n\r\nexport function clearPagingScroll() {\r\n  const pageNumbers = document.querySelector('.result-scroll');\r\n  if (pageNumbers !== null) {\r\n    pageNumbers.style.display = 'none';\r\n  }\r\n}\r\n\r\nexport function showPagingScroll() {\r\n  const pageNumbers = document.querySelector('.result-scroll');\r\n  if (pageNumbers !== null) {\r\n    pageNumbers.style.display = 'block';\r\n  }\r\n}\r\n\r\nexport function addPagingScroll(attr) {\r\n  function addNumberPage(elem, fragment) {\r\n    let li = document.createElement('li');\r\n    li.innerHTML = elem;\r\n    li.addEventListener('click', function () {\r\n      loadTopArtistsOnPage(elem);\r\n    });\r\n    if (currentPage == elem) {\r\n      li.classList.add('current');\r\n    }\r\n    fragment.appendChild(li);\r\n  }\r\n\r\n  if (!(attr instanceof Object) && !attr['page']) return;\r\n  showPagingScroll();\r\n  const currentPage = attr['page'];\r\n  const totalPages = attr['totalPages'];\r\n\r\n  const arr = generateRangeForPagination(currentPage, totalPages);\r\n  const pageNumbers = document.querySelector('.result-scroll');\r\n  pageNumbers.innerHTML = '';\r\n\r\n  const fragment = document.createDocumentFragment();\r\n\r\n  arr.forEach(function (elem) {\r\n    addNumberPage(elem, fragment)\r\n  });\r\n\r\n  pageNumbers.appendChild(fragment);\r\n}\r\n\r\nexport function addArtistImage(artist, root, clazz) {\r\n  let image = document.createElement('img');\r\n  image.src = artist['image'][2]['#text'];\r\n  image.title = artist.name;\r\n  image.className = clazz;\r\n  root.appendChild(image);\r\n  return image;\r\n}\r\n\r\nfunction handleResponseOfTopArtists(response) {\r\n  if (!(response instanceof Object)) return;\r\n\r\n  let resultBox = document.querySelector('.result-box');\r\n  resultBox.innerHTML = '';\r\n  let elements = document.createDocumentFragment();\r\n\r\n  const artists = response['artists']['artist'];\r\n\r\n  artists.forEach(function (artist) {\r\n    addArtistImage(artist, elements, 'element').addEventListener('click', function (event) {\r\n      artistHandler.loadArtistOnMainPage(event.currentTarget.title);\r\n    });\r\n  });\r\n\r\n  let pageAttr = response['artists']['@attr'];\r\n  addPagingScroll(pageAttr, elements);\r\n  resultBox.appendChild(elements);\r\n}\r\n\r\nexport function addHead(head) {\r\n  document.querySelector('.head').innerHTML = head;\r\n}\r\n\r\nfunction loadTopArtistsOnPage(number = 1) {\r\n  if (typeof (number) === 'object') {\r\n    number = 1;\r\n  }\r\n\r\n  clearLikeBox();\r\n  addHead('Top artists:');\r\n  addSpinner();\r\n\r\n  let loader = new ArtistList();\r\n  let response = loader.load(number);\r\n\r\n  response\r\n    .then(res => {\r\n      const responseObj = JSON.parse(res.responseText);\r\n      handleResponseOfTopArtists(responseObj)\r\n    });\r\n}\r\n\r\nexport function addSpinner() {\r\n  const resultBox = document.querySelector('.result-box');\r\n  resultBox.innerHTML = '';\r\n  const spinner = document.createElement('div');\r\n  spinner.classList.add('spinner');\r\n  resultBox.appendChild(spinner);\r\n}\r\n\r\nexport function addLikes(likes) {\r\n  const likeBox = document.querySelector('.stars');\r\n  likeBox.style.display = 'block';\r\n  likeBox.innerHTML = likes + ' likes';\r\n}\r\n\r\nexport function clearLikeBox() {\r\n  const likeBox = document.querySelector('.stars');\r\n  likeBox.style.display = 'none';\r\n  likeBox.innerHTML = '';\r\n}\r\n\r\nexport function cleanContentForArtist() {\r\n  const scroll = document.querySelector('.result-scroll');\r\n  const current = document.querySelector('.result-scroll .current');\r\n  if (scroll !== null) {\r\n    scroll.innerHTML = '';\r\n    current.innerHTML = 'Back to list';\r\n    current.className = 'back-to-result';\r\n    scroll.appendChild(current);\r\n  }\r\n}\r\n\r\nlet label = document.getElementById('label');\r\nlabel.addEventListener('click', loadTopArtistsOnPage);\r\n\r\nwindow.onload = loadTopArtistsOnPage;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./handlers/mainHandler.js\n// module id = 2\n// module chunks = 0","'use strict';\r\nimport Loader from './loader';\r\n\r\nexport default function AlbumsList() {\r\n  const method = 'artist.getTopAlbums';\r\n\r\n  this.load = function (artist) {\r\n    const methodQuery = this.__proto__.returnMethodQuery(method);\r\n    const artistQuery = this.__proto__.returnArtistParameter(artist);\r\n    const fullQuery = this.__proto__.START_URL + methodQuery + artistQuery +\r\n      this.__proto__.generateLimit(20) + this.__proto__.QUERY_POSTFIX;\r\n    console.log(fullQuery);\r\n    return this.__proto__.load(fullQuery);\r\n  };\r\n}\r\n\r\nLoader.prototype.inherits(AlbumsList);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./classes/albumsList.js\n// module id = 3\n// module chunks = 0","'use strict';\r\nimport Loader from './loader';\r\n\r\nexport default function ArtistInfo() {\r\n  this.load = function (artist) {\r\n    const method = 'artist.getinfo';\r\n    const methodQuery = this.__proto__.returnMethodQuery(method);\r\n    const artistQuery = this.__proto__.returnArtistParameter(artist);\r\n    const fullQuery = this.__proto__.START_URL + methodQuery + artistQuery + this.__proto__.QUERY_POSTFIX;\r\n    console.log(fullQuery);\r\n    return this.__proto__.load(fullQuery);\r\n  };\r\n}\r\n\r\nLoader.prototype.inherits(ArtistInfo);\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./classes/artistInfo.js\n// module id = 4\n// module chunks = 0","'use strict';\r\nimport Loader from './loader';\r\n\r\nexport default function ArtistList() {\r\n  const method = 'chart.gettopartists';\r\n\r\n  this.load = function (page) {\r\n    const fullQuery = this.START_URL + this.returnMethodQuery(method) +\r\n      this.generatePage(page) + this.generateLimit(50) + this.QUERY_POSTFIX;\r\n    console.log(fullQuery);\r\n    return this.__proto__.load(fullQuery);\r\n  };\r\n}\r\n\r\nLoader.prototype.inherits(ArtistList);\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./classes/artistList.js\n// module id = 5\n// module chunks = 0","'use strict';\r\nimport Loader from './loader';\r\n\r\nexport default function ArtistSearch() {\r\n  this.load = function (artist, page) {\r\n    page = page || 1;\r\n    const method = 'artist.search';\r\n    const methodQuery = this.__proto__.returnMethodQuery(method);\r\n    const artistQuery = this.__proto__.returnArtistParameter(artist);\r\n    const fullQuery = this.__proto__.START_URL + methodQuery + artistQuery +\r\n      this.__proto__.generatePage(page) + this.__proto__.QUERY_POSTFIX;\r\n    console.log(fullQuery);\r\n    return this.__proto__.load(fullQuery);\r\n  };\r\n}\r\n\r\nLoader.prototype.inherits(ArtistSearch);\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./classes/searchArtist.js\n// module id = 6\n// module chunks = 0","'use strict';\r\nimport Loader from './loader';\r\n\r\nexport default function AlbumInfo() {\r\n\r\n  this.load = function (artist, album) {\r\n    const method = 'album.getinfo';\r\n    const methodQuery = this.__proto__.returnMethodQuery(method);\r\n    const artistQuery = this.__proto__.returnArtistParameter(artist);\r\n    const albumQuery = this.__proto__.returnAlbumParameter(album);\r\n    const fullQuery = this.__proto__.START_URL + methodQuery + artistQuery + albumQuery + this.QUERY_POSTFIX;\r\n    console.log(fullQuery);\r\n    return this.__proto__.load(fullQuery);\r\n  }\r\n}\r\n\r\nLoader.prototype.inherits(AlbumInfo);\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./classes/albumInfo.js\n// module id = 7\n// module chunks = 0","'use strict';\r\nimport * as mainHandler from '../handlers/mainHandler';\r\nimport * as artistHandler from '../handlers/artistHandler';\r\nimport ArtistSearch from '../classes/searchArtist';\r\n\r\nfunction handleResponseOfSearchArtists(response) {\r\n  if (!(response instanceof Object)) return;\r\n\r\n  const resultBox = document.querySelector('.result-box');\r\n  const fragment = document.createDocumentFragment();\r\n  resultBox.innerHTML = '';\r\n  const artists = response[\"results\"][\"artistmatches\"][\"artist\"];\r\n\r\n  artists.forEach(function (artist) {\r\n    mainHandler.addArtistImage(artist, fragment, 'element').addEventListener('click', function (event) {\r\n      artistHandler.loadArtistOnMainPage(event.currentTarget.title);\r\n    });\r\n  });\r\n\r\n  let {page, totalPages} = 4;\r\n\r\n  resultBox.appendChild(fragment);\r\n}\r\n\r\nfunction searchArtist(page) {\r\n  if (typeof (page) === 'object') {\r\n    page = 1;\r\n  }\r\n  page = page || 1;\r\n  const querySearch = document.querySelector(\".search-box input[type='text']\");\r\n  const value = querySearch.value;\r\n\r\n  if ((querySearch === null) || (value === '')) return;\r\n\r\n  const loader = new ArtistSearch();\r\n  const response = loader.load(value, page);\r\n\r\n  mainHandler.clearPagingScroll();\r\n  mainHandler.clearLikeBox();\r\n  mainHandler.addHead('Result of search: ' + value);\r\n  mainHandler.addSpinner();\r\n\r\n  response\r\n    .then(res =>{\r\n      const responseObj = JSON.parse(res.responseText);\r\n      handleResponseOfSearchArtists(responseObj);\r\n    });\r\n}\r\n\r\nlet searchButton = document.getElementById('startSearch');\r\nsearchButton.addEventListener('click', searchArtist);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./handlers/searchHandler.js\n// module id = 8\n// module chunks = 0"],"sourceRoot":""}